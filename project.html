<!DOCTYPE html>
<html xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <meta charset="utf-8">
    <title>Project</title>
    <link rel="stylesheet" href="project.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="raphael-min.js"></script>
    <script src="publicApi.js"></script>
    <script src="uijs.js"></script>
    <script src="login.js"></script>
    <script src="map.js"></script>
    <script src="room.js"></script>
    <script src="javaUtils.js"></script>
    <script src="/socket.io/socket.io.js"></script>



    <link href='http://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>

</head>
<body>
    <div class="container">
        <header>
            <div class="left">
                <h1>Conquiztador</h1>
            </div>
            <div class="right login">
                <div id="fb-root"></div>

                <script type="text/javascript">
                    var button;
                    var userInfo;

                    window.fbAsyncInit = function()
                    {
                       FB.init({ appId: '134519973357696', status: true, cookie: true, xfbml: true, oauth: true});
                       showLoader(true);

                       function updateButton(response)
                       {
                            button       =   document.getElementById('fb-auth');
                            userInfo     =   document.getElementById('user-info');

                            if (response.authResponse)
                            {
                                //user is already logged in and connected
                                FB.api('/me', function(info) { login(response, info); } ) ;
                                button.onclick = function() { FB.logout(function(response) { logout(response); } ) ; } ;

                            }
                            else
                            {
                                //user is not connected to your app or logged out
                                button.innerHTML = 'Login';
                                button.onclick = function() {
                                    showLoader(true);
                                    FB.login( function(response) {
                                        if (response.authResponse) {
                                            FB.api('/me', function(info) { login(response, info); });
                                        }
                                        else
                                        {
                                            //user cancelled login or did not grant authorization
                                            showLoader(false);
                                        }
                                    }, {scope:'email,user_birthday,status_update,publish_stream,user_about_me'} ) ;
                                }
                            }
                        }

                        // run once with current status and whenever the status changes
                        FB.getLoginStatus(updateButton);
                        FB.Event.subscribe('auth.statusChange', updateButton);
                    };

                    (function() {
                        var e = document.createElement('script'); e.async = true;
                        e.src = document.location.protocol
                            + '//connect.facebook.net/en_US/all.js';
                        document.getElementById('fb-root').appendChild(e);
                    }());


                    function login(response, info)
                    {
                        if (response.authResponse)
                        {
                            //showLoader(false);
                            //username = info.name ;
                            loggedIn2 ( info.name , info.id );
                        }
                    }

                    function logout(response)
                    {
                        userInfo.innerHTML                             =   "";
                        document.getElementById('other').style.display =   "none";
                        showLoader(false);
                    }

                    function showLoader(status)
                    {
                        if (status)
                            document.getElementById('loader').style.display = 'block';
                        else
                            document.getElementById('loader').style.display = 'none';
                    }
                </script>

                <button id="fb-auth">Login</button>
                <div id="loader" style="display:none">
                    <img src="ajax-loader.gif" alt="loading" />
                </div>
                <br />
                <div id="user-info"></div>
            </div> <!-- login end -->
        </header>

        <div class="roomSelect">
            <div class="addNewRoom"><p>+ Click to add a new Room +</p></div>
            <div class="unconnectedUsers"><p>Unconnected Users</p>
                <div class="uncoonectedUsersBlock"></div>
            </div>
        </div>
        <div class="shouldBeHiddenBeforeEnteringAGame">
            <div id="canvasRaphael"></div>
            <ul id="score">
                <li class="casuta">username:score</li>
                <li class="casuta">username:score</li>
                <li class="casuta">username:score</li>
                <li class="casuta">username:score</li>
            </ul>
        </div>
        <button type="button" id="addQuestion">Clickme!</button>
        <div id="pop-up4a">
            <p id="question"></p>
            <p id="answer1" class="left answer"></p>
            <p id="answer2" class="right answer"></p>
            <p id="answer3" class="left answer"></p>
            <p id="answer4" class="right answer"></p>
        </div>
        <div class="shouldBeHiddenUntilLogin">
            <button type="button" id="javaTest" onclick="connect()">Connect</button>
            <button type="button" id="javaTest2" onclick="sendTestMessage()">Test message</button>
        </div>
            <pre id="log">Log:<br /></pre>
    </div>
</body>

</html>
